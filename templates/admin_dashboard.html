<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vortex - Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        body { background: #1e1e2f; color: #f0f0f0; }
        .card { background: #2a2a40; border-radius: 15px; margin-bottom: 20px; }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 3rem;
            font-weight: 800;
        }
    </style>
</head>

<body>

<nav class="navbar navbar-dark bg-dark px-4 shadow-sm mb-4">
    <a class="navbar-brand fw-bold" href="#">Vortex Admin</a>
    <div>
        <a href="{{ url_for('admin_users') }}" class="btn btn-outline-light me-2">Users</a>
        <a href="{{ url_for('admin_logout') }}" class="btn btn-outline-danger">Logout</a>
    </div>
</nav>

<div class="container mt-5">
    <h1 class="mb-4">Admin Dashboard</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="row mb-4">
        <div class="col-md-3">
            <div class="stat-card shadow">
                <i class="bi bi-people" style="font-size: 2rem;"></i>
                <div class="stat-number">{{ total_users }}</div>
                <p>Total Users</p>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card shadow" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <i class="bi bi-file-earmark" style="font-size: 2rem;"></i>
                <div class="stat-number">{{ total_uploads }}</div>
                <p>Total Uploads</p>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card shadow" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <i class="bi bi-card-checklist" style="font-size: 2rem;"></i>
                <div class="stat-number">{{ total_quizzes }}</div>
                <p>Total Quizzes</p>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card shadow" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                <i class="bi bi-lightning" style="font-size: 2rem;"></i>
                <div class="stat-number">{{ total_battles }}</div>
                <p>Quiz Battles</p>
            </div>
        </div>
    </div>

    <div class="card shadow p-4 mb-4">
        <h5 class="mb-3">Recent Users</h5>
        <table class="table table-dark table-hover">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Email</th>
                    <th>Score</th>
                    <th>Level</th>
                    <th>Joined</th>
                </tr>
            </thead>
            <tbody>
                {% for user in recent_users %}
                <tr>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.score }}</td>
                    <td>{{ user.level }}</td>
                    <td>{{ user.created_at.strftime('%Y-%m-%d') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="card shadow p-4">
        <h5 class="mb-3">Recent Uploads</h5>
        <table class="table table-dark table-hover">
            <thead>
                <tr>
                    <th>Filename</th>
                    <th>User</th>
                    <th>Shared</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for upload in recent_uploads %}
                <tr>
                    <td>{{ upload.filename }}</td>
                    <td>{{ upload.user.username }}</td>
                    <td>
                        {% if upload.is_shared %}
                        <span class="badge bg-success">Yes</span>
                        {% else %}
                        <span class="badge bg-secondary">No</span>
                        {% endif %}
                    </td>
                    <td>{{ upload.uploaded_at.strftime('%Y-%m-%d') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>