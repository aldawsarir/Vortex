<!DOCTYPE html>
<html lang="{{ current_lang }}" {% if current_lang == 'ar' %}dir="rtl"{% endif %}>
<head>
<meta charset="UTF-8">
<title>Vortex - {{ t('flashcards') }}</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
body.light-mode{background:#f0f8ff;color:#333;}
body.dark-mode{background:#1e1e2f;color:#f0f0f0;}

.progress-container{position:sticky;top:0;z-index:1000;background:inherit;padding:20px 0;margin-bottom:30px;}

.progress{height:35px;border-radius:20px;background:rgba(0,0,0,0.1);overflow:hidden;}
.progress-bar{background:linear-gradient(90deg,#667eea 0%,#764ba2 100%);border-radius:20px;font-weight:700;font-size:1rem;}

.flashcard-container{perspective:1500px;width:100%;max-width:700px;height:450px;margin:0 auto 40px;cursor:pointer;}
.flashcard{width:100%;height:100%;position:relative;transition:transform .6s;transform-style:preserve-3d;}
.flashcard.flipped{transform:rotateY(180deg);}

.flashcard-face{
position:absolute;width:100%;height:100%;
backface-visibility:hidden;border-radius:25px;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
padding:40px;box-shadow:0 10px 40px rgba(0,0,0,.2);
}

.flashcard-front{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;}
.flashcard-back{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;transform:rotateY(180deg);}

.flashcard-label{font-size:1rem;font-weight:600;margin-bottom:20px;text-transform:uppercase;letter-spacing:2px;}
.flashcard-text{font-size:2rem;font-weight:700;text-align:center;}

.flashcard-hint{position:absolute;bottom:30px;font-size:.9rem;opacity:.8;}

.action-buttons{display:flex;gap:20px;justify-content:center;margin-bottom:30px;}

.btn-know{
background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%);
color:white;border:none;padding:15px 40px;
border-radius:15px;font-weight:700;
}

.btn-dont-know{
background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);
color:white;border:none;padding:15px 40px;
border-radius:15px;font-weight:700;
}

.card-counter{text-align:center;font-size:1.2rem;font-weight:600;margin-bottom:30px;}

.results-container{display:none;text-align:center;padding:50px 20px;}
.results-container.show{display:block;}

.score-circle{
width:250px;height:250px;border-radius:50%;
background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
display:flex;flex-direction:column;
align-items:center;justify-content:center;
margin:0 auto 40px;
}

.score-number{font-size:4rem;font-weight:900;color:white;}
.score-label{font-size:1.2rem;color:white;}

footer{background:#1f2d3d;color:#ddd;padding:30px 0;margin-top:80px;text-align:center;}
body.dark-mode footer{background:#111;}
</style>
</head>

<body class="light-mode">

{% include 'navbar.html' %}

<div class="container mt-5">

<div class="progress-container">
<h4 class="text-center mb-3">{{ t('flashcards_review') }}</h4>
<div class="progress">
<div id="progress-bar" class="progress-bar" style="width:0%">0%</div>
</div>
</div>

<div class="flashcards-section" id="flashcards-section">

<div class="card-counter">
{{ t('card') }} <span id="current-card">1</span>
{{ t('of') }}
<span id="total-cards">{{ quiz|length }}</span>
</div>

<div class="flashcard-container" id="flashcard-container">
<div class="flashcard" id="flashcard">

<div class="flashcard-face flashcard-front">
<div class="flashcard-label">{{ t('question') }}</div>
<div class="flashcard-text" id="question-text"></div>
<div class="flashcard-hint">{{ t('click_flip') }}</div>
</div>

<div class="flashcard-face flashcard-back">
<div class="flashcard-label">{{ t('answer') }}</div>
<div class="flashcard-text" id="answer-text"></div>
<div class="flashcard-hint">{{ t('click_flip_back') }}</div>
</div>

</div>
</div>

<div class="action-buttons">
<button class="btn btn-dont-know" id="btn-dont-know">
<i class="bi bi-x-circle"></i> {{ t('dont_know') }}
</button>

<button class="btn btn-know" id="btn-know">
<i class="bi bi-check-circle"></i> {{ t('know_it') }}
</button>
</div>

</div>

<div class="results-container" id="results-section">

<h1 class="mb-4">{{ t('final_results') }}</h1>

<div class="score-circle">
<div class="score-number" id="final-score">0</div>
<div class="score-label">{{ t('points') }}</div>
</div>

<div class="mt-5">
<a href="{{ url_for('quiz_page') }}" class="btn btn-primary btn-lg me-3">
{{ t('go_quiz') }}
</a>
<a href="{{ url_for('home') }}" class="btn btn-secondary btn-lg">
{{ t('home') }}
</a>
</div>

</div>

</div>

<footer>
<div class="container text-center">
{{ t('developed_by') }} <strong>{{ t('team_name') }}</strong>
</div>
</footer>

<script>
const quizData = {{ quiz|tojson }};
let currentIndex=0,known=0,unknown=0,total=quizData.length;

const flashcard=document.getElementById('flashcard');
const q=document.getElementById('question-text');
const a=document.getElementById('answer-text');
const progress=document.getElementById('progress-bar');

document.getElementById('flashcard-container').onclick=()=>flashcard.classList.toggle('flipped');

function load(i){
if(i>=total){show();return;}
q.textContent=quizData[i].q;
a.textContent=quizData[i].a;
progress.style.width=Math.round(i/total*100)+'%';
}

function show(){
document.getElementById('flashcards-section').style.display='none';
document.getElementById('results-section').classList.add('show');
document.getElementById('final-score').textContent=known*10;
}

document.getElementById('btn-know').onclick=()=>{known++;load(++currentIndex);}
document.getElementById('btn-dont-know').onclick=()=>{unknown++;load(++currentIndex);}

load(0);
</script>

</body>
</html>